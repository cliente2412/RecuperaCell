<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Recupera Cell â€” Loja</title>
  <style>
    :root {
      --bg: #000;
      --accent: #ff7a00;
      --card: #111;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: var(--bg);
      color: #fff;
    }

    h1, h2, h3, p { margin: 0; }

    .container {
      max-width: 1100px;
      margin: 20px auto;
      padding: 0 14px;
    }

    .products {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 14px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .thumb {
      background: linear-gradient(135deg, #222, #111);
      height: 100px;
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 32px;
      margin-bottom: 10px;
    }

    .price { color: var(--accent); font-weight: bold; }
    .installments { color: #bbb; font-size: 13px; margin-top: 4px; }

    .btn {
      background: var(--accent);
      border: none;
      color: #111;
      padding: 8px 12px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 8px;
      width: 100%;
    }

    /* CARRINHO */
    .cart {
      position: fixed;
      right: 10px;
      bottom: 10px;
      width: 90%;
      max-width: 380px;
      background: #0b0b0b;
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 14px;
      z-index: 50;
      transition: transform 0.3s ease;
    }

    .cart.minimized {
      transform: translateY(calc(100% - 46px));
    }

    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }

    .cart-items {
      margin-top: 10px;
      max-height: 220px;
      overflow-y: auto;
    }

    .cart-item {
      background: rgba(255,255,255,0.02);
      padding: 8px;
      border-radius: 8px;
      margin-bottom: 8px;
    }

    .cart-item div {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-item .remove {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.1);
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
      padding: 4px 8px;
    }

    .checkout { margin-top: 10px; }
    .checkout input, .checkout textarea {
      width: 100%;
      margin-top: 8px;
      padding: 10px;
      background: #070707;
      border: 1px solid rgba(255,255,255,0.08);
      color: #fff;
      border-radius: 8px;
    }

    footer {
      text-align: center;
      color: #999;
      font-size: 13px;
      margin-top: 30px;
      padding: 10px;
    }

    @media (max-width: 500px) {
      .cart { width: 94%; }
    }
  </style>
</head>
<body>
  <main class="container">
    <h1>Recupera Cell</h1>
    <p style="color:#bbb;margin-bottom:20px;">ManutenÃ§Ã£o & AcessÃ³rios</p>

    <section class="products" id="products"></section>
  </main>

  <aside class="cart minimized" id="cart">
    <div class="cart-header" id="cart-toggle">
      <h2>ðŸ›’ Carrinho</h2>
      <button id="toggle-btn" style="background:none;border:0;color:#fff;">â–²</button>
    </div>

    <div class="cart-content" id="cart-content">
      <div class="cart-items" id="cart-items"></div>
      <div style="margin-top:8px;display:flex;justify-content:space-between;">
        <strong>Total:</strong> <span id="cart-total">R$ 0,00</span>
      </div>
      <div class="installments" id="cart-installments"></div>

      <div class="checkout">
        <label for="phone">Telefone/WhatsApp:</label>
        <input id="phone" placeholder="(55) 24 98842-1242" />
        <label for="obs">ObservaÃ§Ãµes:</label>
        <textarea id="obs" rows="2" placeholder="Ex: Modelo do aparelho"></textarea>
        <button class="btn" id="place-order">Simular Pedido / WhatsApp</button>
      </div>
    </div>
  </aside>

  <footer>Recupera Cell Â© <span id="year"></span> â€” Desenvolvido por Eliseu Tach</footer>

  <script>
    const WHATSAPP_NUMBER = '5524988421242';
    const JUROS_MENSAL = 0.03; // 3% ao mÃªs
    const MAX_PARCELAS = 12;

    const PRODUCTS = [
      {id:1, name:'Troca de Tela iPhone 11', price:249.00},
      {id:2, name:'Bateria iPhone XR', price:129.00},
      {id:3, name:'Conector de Carga USB-C', price:79.90},
      {id:4, name:'Reparo de Placa LÃ³gica', price:399.00},
      {id:5, name:'PelÃ­cula Temperada', price:29.90},
      {id:6, name:'Capinha Silicone', price:39.90}
    ];

    const money = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
    let CART = JSON.parse(localStorage.getItem('rc_cart')||'{}');
    const save = ()=>localStorage.setItem('rc_cart',JSON.stringify(CART));

    function calcParcelado(valor, parcelas, juros){
      // fÃ³rmula: valor * ((1 + juros)^parcelas * juros) / ((1 + juros)^parcelas - 1)
      const v = valor * ((Math.pow(1 + juros, parcelas) * juros) / (Math.pow(1 + juros, parcelas) - 1));
      return v;
    }

    function renderProducts(){
      const wrap=document.getElementById('products');
      wrap.innerHTML='';
      for(const p of PRODUCTS){
        const parcela = calcParcelado(p.price, MAX_PARCELAS, JUROS_MENSAL);
        const div=document.createElement('div');
        div.className='card';
        div.innerHTML = `
          <div class="thumb">ðŸ“±</div>
          <h3>${p.name}</h3>
          <div class="price">${money(p.price)}</div>
          <div class="installments">ou ${MAX_PARCELAS}x de ${money(parcela)} com juros</div>
          <button class="btn" data-id="${p.id}">Adicionar</button>
        `;
        wrap.appendChild(div);
      }
      wrap.querySelectorAll('.btn').forEach(b => 
        b.addEventListener('click', e => addToCart(Number(e.target.dataset.id)))
      );
    }

    function addToCart(id){
      const p = PRODUCTS.find(x => x.id===id);
      if(!CART[id]) CART[id]={...p,qty:0};
      CART[id].qty++;
      save();
      renderCart();
    }

    function removeFromCart(id){
      delete CART[id];
      save();
      renderCart();
    }

    function renderCart(){
      const wrap=document.getElementById('cart-items');
      wrap.innerHTML='';
      const items=Object.values(CART);
      let total=0;
      for(const it of items){
        total+=it.price*it.qty;
        const div=document.createElement('div');
        div.className='cart-item';
        div.innerHTML=`
          <div><strong>${it.name}</strong> <button class="remove" data-id="${it.id}">Remover</button></div>
          <div><span>${it.qty}x ${money(it.price)}</span> <strong>${money(it.price*it.qty)}</strong></div>
        `;
        wrap.appendChild(div);
      }
      document.getElementById('cart-total').textContent=money(total);
      if(total>0){
        const parcela = calcParcelado(total, MAX_PARCELAS, JUROS_MENSAL);
        document.getElementById('cart-installments').textContent = 
          `ou ${MAX_PARCELAS}x de ${money(parcela)} com juros (3% a.m.)`;
      } else {
        document.getElementById('cart-installments').textContent = '';
      }
      wrap.querySelectorAll('.remove').forEach(b=>b.onclick=()=>removeFromCart(b.dataset.id));
    }

    document.getElementById('place-order').onclick=()=>{
      if(Object.keys(CART).length===0){alert('Carrinho vazio');return;}
      const phone=document.getElementById('phone').value.trim();
      const obs=document.getElementById('obs').value.trim();
      let msg='*Pedido Recupera Cell*%0A';
      let total=0;
      for(const i of Object.values(CART)){
        total+=i.price*i.qty;
        msg+=`â€¢ ${i.name} (${i.qty}x ${money(i.price)})%0A`;
      }
      const parcela = calcParcelado(total, MAX_PARCELAS, JUROS_MENSAL);
      msg+=`%0A*Total:* ${money(total)}%0Aou ${MAX_PARCELAS}x de ${money(parcela)} com juros (3% a.m.)%0A`;
      if(phone) msg+=`*Contato:* ${encodeURIComponent(phone)}%0A`;
      if(obs) msg+=`*Obs:* ${encodeURIComponent(obs)}%0A`;
      window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`,'_blank');
    };

    document.getElementById('cart-toggle').onclick=()=>{
      const cart=document.getElementById('cart');
      cart.classList.toggle('minimized');
      document.getElementById('toggle-btn').textContent=cart.classList.contains('minimized')?'â–²':'â–¼';
    };

    document.getElementById('year').textContent=new Date().getFullYear();
    renderProducts();
    renderCart();
  </script>
</body>
</html>
